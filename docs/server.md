# Generating the server

explicar brevemente como funciona

## OpenAPI Generator

OpenAPI Generator allows generation of API client libraries (SDK generation), server stubs, documentation and 
configuration automatically given an OpenAPI Spec (both 2.0 and 3.0 are supported). The OpenAPI Generator website
maintains a list of languages/frameworks are supported. [OpenAPI Generator](https://github.com/OpenAPITools/openapi-generator#overview)

### Integration with RDF

The OpenAPI Generator easily provide an API backend for mocking based on the OpenAPI Specification. However, it does not
provide the logic of the server (For example, a database connection).

OBA modify the server generated by OpenAPI Generator using templates. This new server can:

 1. Connect and query a SPARQL endpoint.
 2. Convert the RDF triples to JSON (using JSON/LD).
 
## Generating the server

### How to generate it?

!!info
    You must install Docker.
    
You must run the script.

```bash
$ bash generate-server.sh
...
...
SUCCESS
```


### Generating the JSON/LD context

Since the adoption of JSON/LD is in progress, OBA can responses using JSON.
To do that, OBA requires the file with the context. Simply speaking, a context is used to map terms to IRIs. 

!!! info 
    Visit the [JSON/LD documentation](https://json-ld.org/spec/latest/json-ld/#the-context) for more information

Currently, OBA does not support the generation of the context file. 
We recommend to use the project [owl2jsonld](https://github.com/stain/owl2jsonld)


#### One ontology

If you are using one only. You can run:

```bash
java -jar owl2jsonld-0.3.0-SNAPSHOT-standalone.jar  \
    https://mintproject.github.io/Mint-ModelCatalog-Ontology/release/1.2.0/ontology.xml > server/context.json
```

### Two or more ontologies

To merge the multiple JSON files, you can install the [jq](https://stedolan.github.io/jq/)

```bash

java -jar owl2jsonld-0.3.0-SNAPSHOT-standalone.jar  \
    $ONTOLOGY_URL1 > a.json
java -jar owl2jsonld-0.3.0-SNAPSHOT-standalone.jar \
    $ONTOLOGY_URL2 > b.json    
jq -s '.[0] * .[1]' a.json b.json  | jq -S > server/contexts/context.json
rm a.json b.json

```

For the Model Catalog ontology:

```bash

java -jar owl2jsonld-0.3.0-SNAPSHOT-standalone.jar  \
    https://mintproject.github.io/Mint-ModelCatalog-Ontology/release/1.2.0/ontology.xml > a.json
java -jar owl2jsonld-0.3.0-SNAPSHOT-standalone.jar \
    https://knowledgecaptureanddiscovery.github.io/SoftwareDescriptionOntology/release/1.2.0/ontology.xml > b.json
jq -s '.[0] * .[1]' a.json b.json  | jq -S > server/contexts/context.json
rm a.json b.json

```